<div class='dock fill'>
  <div class='toggler icons fill-w'>
    <% if (isNew() || get('Datasource') && get('Datasource').file) {%>
    <a href='#layerFile' class='active'><span class='icon file'></span>File</a>
    <% } %>
    <% if (isNew() || get('Datasource') && get('Datasource').type === 'postgis') {%>
    <a href='#layerPostGIS' <% if(get('Datasource')) { %>class='active'<% } %>><span class='icon postgis'></span>PostGIS</a>
    <% } %>
  </div>

  <% if (isNew() || get('Datasource') && get('Datasource').file) {%>
  <form class='layerFile active'><ul class='form'>
    <li class='text'>
      <h2>File</h2>
      <div class='description'>Use a URL or filepath to a shape, kml, geotiff or geojson file for this layer.</div>
    </li>
    <li>
      <label for='id'><span class='required'>*</span> ID</label>
      <input type='text' name='id' value='<%=get('id')%>' size='20'/>
      <span class='description'>select in Carto <code>#id</code></span>
    </li>
    <li>
      <label for='class'>Class</label>
      <input type='text' name='class' value='<%=get('class')%>' size='20'/>
      <span class='description'>select in Carto <code>.class</code></span>
    </li>
    <li class='toggler'>
      <label for='file'><span class='required'>*</span> Datasource</label>
      <input type='text' name='file' value='<%= get('Datasource') ? get('Datasource').file : '' %>' size='60'/>
      <a href='#fileBrowser' class='button'>Browse</a>
      <div class='fileBrowser browser'></div>
    </li>
    <li>
      <label for='srs-name'>SRS</label>
      <select name='srs-name'>
        <option value='autodetect' <% if (srsName() === 'autodetect') { %>selected='selected'<% } %>>
          Autodetect
        </option>
        <option value='900913' <% if (srsName() === '900913') { %>selected='selected'<% } %>>
          900913
        </option>
        <option value='WGS84'  <% if (srsName() === 'WGS84') { %>selected='selected'<% } %>>
          WGS84
        </option>
        <option value='custom' <% if (srsName() === 'custom') { %>selected='selected'<% } %>>
          Custom
        </option>
      </select>
      <input type='text' name='srs' value='<%=get('srs')%>' size='40' placeholder='Autodetect' />
      <div class='description'>SRS projection string for this datasource. TileMill can often autodetect this value.</div>
    </li>
    <li class='buttons'>
      <input type='submit' value='Save' />
      <input type='button' value='Cancel' class='cancel' />
    </li>
  </ul></form>
  <% } %>

  <% if (isNew() || get('Datasource') && get('Datasource').type === 'postgis') {%>
  <form class='layerPostGIS'><ul class='form'>
    <li class='text'>
      <h2>PostGIS</h2>
      <div class='description'>Use a table or SQL query against a PostGIS database for this layer.</div>
    </li>
    <li>
      <label for='id'><span class='required'>*</span> ID</label>
      <input type='text' name='id' value='<%=get('id')%>' size='20'/>
      <span class='description'>select in Carto <code>#id</code></span>
    </li>
    <li>
      <label for='class'>Class</label>
      <input type='text' name='class' value='<%=get('class')%>' size='20'/>
      <span class='description'>select in Carto <code>.class</code></span>
    </li>
    <li>
      <label for='connection'><span class='required'>*</span> Connection</label>
      <input type='text' name='connection' id='connection' placeholder='pgsql://user:password@localhost:5432/database' value='<%= get('connection') %>' size='60' />
      <a href='#dbBrowser' class='button'>Browse</a>
      <div class='dbBrowser browser'></div>
    </li>
    <li>
      <label for='table'><span class='required' title='This field is required'>*</span> Query</label>
      <div class='inline'>
        <pre>SELECT * FROM </pre>
        <textarea name='table' cols='60' rows='4'><%=get('table')%></textarea>
      </div>
    </li>
    <li>
      <label for='extent'>Extent</label>
      <input type='text' name='extent' value='<%=get('extent')%>' />
      <span class='description'>limit the query by this bounding box</span>
    </li>
    <li>
      <label for='extent'>Geometry Field</label>
      <input type='text' name='geometry_field' value='<%=get('geometry_field')%>' />
      <span class='description'>SQL field containing feature geometry</span>
    </li>
    <li>
      <label for='srs-name'>SRS</label>
      <select name='srs-name'>
        <option value='900913' <% if (srsName() === '900913') { %>selected='selected'<% } %>>
          900913
        </option>
        <option value='WGS84'  <% if (srsName() === 'WGS84') { %>selected='selected'<% } %>>
          WGS84
        </option>
        <option value='custom' <% if (srsName() === 'custom') { %>selected='selected'<% } %>>
          Custom
        </option>
      </select>
      <input type='text' name='srs' value='<%=get('srs')%>' size='40' placeholder='<%=SRS["900913"]%>' />
      <div class='description'>SRS projection string for this datasource.</div>
    </li>
    <li class='buttons'>
      <input type='submit' value='Save' />
      <input type='button' value='Cancel' class='cancel' />
    </li>
  </ul></form>
  <% } %>

</div>


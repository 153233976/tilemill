<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Strict//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
    <title>TileMill</title>
    <link rel='shortcut icon' href='images/favicon.ico' type='image/x-icon' />
    <link rel='stylesheet' href='css/reset.css' type='text/css'/>
    <link rel='stylesheet' href='css/tilemill.css' type='text/css'/>
    <link rel='stylesheet' href='js/tipsy/src/stylesheets/tipsy.css' type='text/css'/>
    <link rel='stylesheet' href='js/colorpicker/css/colorpicker.css' type='text/css'/>

    <script type='text/javascript' src='js/libraries/md5.js'></script>
    <script type='text/javascript' src='js/libraries/base64.js'></script>
    <script type='text/javascript' src='js/libraries/jquery.js'></script>
    <script type='text/javascript' src='js/libraries/underscore-min.js'></script>
    <script type='text/javascript' src='js/libraries/backbone.js'></script>
    <script type='text/javascript' src='js/libraries/jquery-ui.js'></script>
    <script type='text/javascript' src='js/libraries/jquery.tablesorter.min.js'></script>
    <script type='text/javascript' src='js/libraries/ICanHaz.min.js'></script>
    <script type='text/javascript' src='js/openlayers/OpenLayers.js'></script>
    <script type='text/javascript' src='js/colorpicker/js/colorpicker.js'></script>
    <script type='text/javascript' src='js/codemirror/js/codemirror.js'></script>
    <script type='text/javascript' src='js/tipsy/src/javascripts/jquery.tipsy.js'></script>

    <!-- common server/client side js -->
    <script type='text/javascript' src='js/project.js'></script>

    <script type='text/javascript' src='js/app.popup.js'></script>
    <script type='text/javascript' src='js/app.tools.js'></script>
    <script type='text/javascript' src='js/app.project.js'></script>
    <script type='text/javascript' src='js/app.layer.js'></script>
    <script type='text/javascript' src='js/app.stylesheet.js'></script>
    <script type='text/javascript' src='js/app.reference.js'></script>
    <script type='text/javascript' src='js/app.datasource.js'></script>
    <script type='text/javascript' src='js/app.map.js'></script>
    <script type='text/javascript' src='js/app.js'></script>
    <script type='text/javascript' src='js/data.reference.js'></script>

    <!--
    @TODO head.js is causing problems with browser caches during development.
    <script type='text/javascript' src='js/libraries/head.min.js'></script>
    <script type='text/javascript'>
    head.js(
        'js/libraries/md5.js',
        'js/libraries/base64.js',
        'js/libraries/jquery.js',
        'js/libraries/underscore-min.js',
        'js/libraries/backbone.js',
        'js/libraries/jquery-ui.js',
        'js/libraries/jquery.tablesorter.min.js',
        'js/libraries/ICanHaz.min.js',
        'js/openlayers/OpenLayers.js',
        'js/codemirror/js/codemirror.js',

        'js/app.popup.js',
        'js/app.tools.js',
        'js/app.project.js',
        'js/app.layer.js',
        'js/app.stylesheet.js',
        'js/app.reference.js',
        'js/app.datasource.js',
        'js/app.map.js',
        'js/app.js',
        'js/data.reference.js',
    );
    </script>
    -->

    <script type='text/html' id='ProjectListView'>
    <div id='header' class='clearfix'>
      <h1>TileMill</h1>
      <span class='links'>
        <a class='info' href='#info'>About</a>
        <a class='settings' href='#'>Settings</a>
      </span>
    </div>
    <div id='content' class='clearfix'>
      <div id='main'>
        <ul class='pane projects clearfix'></ul>
      </div>
      <div id='sidebar'>
        <div class='pane'>
          <form id='projects' class='projects pane'>
            <h2>Add a project</h2>
            <p>Enter the name of your new project.</p>
            <input class='required text alphanum' type='text' />
            <input class='submit' type='submit' value='Add' />
          </form>
        </div>
      </div>
    </div>
    </script>

    <script type='text/html' id='LoadingView'>
      <div id='loading'>
        <div class='loading-text'>
          {{#message}}{{ message }}{{/message}}
        </div>
        <div class='loading'></div>
      </div>
    </script>

    <script type='text/html' id='ErrorView'>
      <div id='header' class='clearfix'>
        <h1>TileMill</h1>
        <a class='home' href='#'>Back home</a>
      </div>
      <div id='content' class='clearfix'>
          <div class='error-page'>{{ message }}</div>
      </div>
    </script>

    <script type='text/html' id='ProjectRowView'>
      <a href='#project/{{id}}'>
        <span class='thumb'><img src='{{ thumb }}'/></span>
        {{id}}
        <span class='icon delete'>Delete</span>
      </a>
    </script>

    <script type='text/html' id='ProjectView'>
      <div id='header' class='clearfix'>
        <h1>Editing {{ id }}</h1>
        <span class='links'>
          <a class='reference' href='#'>Reference</a>
          <a class='settings' href='#'>Settings</a>
        </span>
        <div class='actions clearfix'>
          <a class='save' href='#'>Save</a>
          <a class='icon close' href='#'>Back home</a>
        </div>
      </div>
      <div id='main'></div>
      <div id='toolbar'></div>
      <div id='sidebar'></div>
    </script>

    <script type='text/html' id='LayerListView'>
      <div class='sidebar-header clearfix pane'>
        <h2>Layers</h2>
        <a title='Add layer' href='#' class='tipsy-e icon add'>Add layer</a>
      </div>
      <ul class='sidebar-content'></ul>
    </script>

    <script type='text/html' id='LayerRowView'>
      <div class='handle'></div>
      <a title='Delete layer' class='icon delete' href='#'>Delete</a>
      <a title='Inspect layer values' class='icon inspect' href='#'>Inspect</a>
      <a title='Edit layer' class='icon edit' href='#'>Edit</a>
      <label>{{ name }}</label>
    </script>

    <script type='text/html' id='LayerFieldsView'>
      <table class='features'>
        <thead>
          <tr>
            {{#fields}}
              <th class='{{type}}'><a title='{{{tooltip}}}'>{{name}}</a></th>
            {{/fields}}
          </tr>
        </thead>
        <tbody>
          {{{rows}}}
        </tbody>
      </table>
    </script>

    <script type='text/html' id='LayerFieldsToolTip'>
      <div>{{type}}</div>
      {{#numeric}}
      <div>Max: {{max}}</div>
      <div>Min: {{min}}</div>
      {{/numeric}}
      {{^numeric}}
      <div>Longest: {{max}}</div>
      <div>Shortest: {{min}}</div>
      {{/numeric}}
    </script>

    <script type='text/html' id='LayerFieldsRowsView'>
      {{#features}}
        <tr>
          {{#values}}
          <td class='{{type}}'>{{value}}</td>
          {{/values}}
        </tr>
      {{/features}}
    </script>

    <script type='text/html' id='LayerFieldsViewAllRowsButtonView'>
      <div class="showall"><a class="button" href="#">Show all ({{deferredCount}} more)</a></div>
    </script>

    <script type='text/html' id='MapView'>
      <div id='map-preview-{{id}}'>
        <a class='icon map-fullscreen' href='#'>Fullscreen</a>
        <div id='zoom-display'><h4>Zoom level ?</h4><div class='zoom-in'>+</div><div class='zoom-out'></div>
      </div>
    </script>

    <script type='text/html' id='StylesheetListView'>
      <div id='tabs'>
        <div class='stylesheets'></div>
        <a title='Add stylesheet' class='tipsy-e icon add' href='#'>Add stylesheet</a>
      </div>
      <div id='editor' class='view'></div>
    </script>

    <script type='text/html' id='StylesheetTabView'>
      <span class='name'>{{ id }}</span>
      <span class='icon delete'>Delete</span>
    </script>

    <script type='text/html' id='StylesheetTabEditor'>
      <div class='editor'><textarea></textarea></div>
    </script>

    <script type='text/html' id='StylesheetTools'>
      <div class='tools pane'></div>
    </script>

    <script type='text/html' id='ColorPickerToolView'>
      <a class='icon color-picker' href='#color-picker'>Color picker</a>
    </script>

    <script type='text/html' id='FontPickerToolView'>
      <label>Fonts</label>
      <select class='fonts-list'>
      <option value=''>Select...</option>
      {{#fonts}}<option value='{{.}}'>{{.}}</option>{{/fonts}}
      </select>
    </script>

    <script type='text/html' id='ColorSwatchesToolView'>
      <div class='sidebar-header clearfix pane'>
        <h2>Colors</h2>
      </div>
      <div class='swatches clearfix pane'></div>
    </script>

    <script type='text/html' id='DrawerView'>
      <div class='sidebar-header clearfix pane'>
        <h2>{{title}}</h2>
        <a class='icon close' href='#'>Close</a>
      </div>
      <div class='drawer-content'>
        {{{content}}}
      </div>
    </script>

    <script type='text/html' id='PopupView'>
      <div id='popup'>
        <div class='popup-backdrop'></div>
        <div class='popup'>
          <div class='popup-header clearfix pane'>
            <h2>{{ title }}</h2>
            <a href='#' class='icon close'>Close</a>
          </div>
          <div class='popup-content'>{{{ content }}}</div>
        </div>
      </div>
    </script>

    <script type='text/html' id='ExportJobOptions'>
      <ul>
        <li><a class='export-option export-png' href='#ExportJobImage'>PNG</a></li>
        <li><a class='export-option export-zip' href='#'>Zip</a></li>
        <li><a class='export-option export-mbtiles' href='#'>MBTiles</a></li>
        <li><a class='export-option export-embed' href='#ExportJobEmbed'>Embed</a></li>
      </ul>
    </script>

    <script type='text/html' id='LayerPopupView'>
      <div id='popup-layer' class='clearfix pane'>
        <form id='form-layer'>
          <div><label for='id'>Id <span class="required" title="This field is required">*</span></label>
            <input type='text' class='text required' id='id' value='{{ id }}' />
          </div>
          <div><label for='class'>Class</label>
            <input type='text' class='text' id='class' value='{{ class }}'/>
          </div>
          <div>
            <label for='file'>Data Source <span class="required" title="This field is required">*</span></label>
            <input type='text' class='text required' id='file' value='{{ datasource_file }}' />
            <a class='icon expand-datasources' id='expand-datasources' title='See available datasources'>[+]</a>
            <div class='container datasources hidden'></div>
          </div>
          <div>
            <label for='srs-name'>SRS</label>
            <select id='srs-name'>
              <option value='' {{#srs_name_autodetect}}selected='selected'{{/srs_name_autodetect}}>Autodetect</option>
              <option value='900913' {{#srs_name_900913}}selected='selected'{{/srs_name_900913}}>900913</option>
              <option value='WGS84' {{#srs_name_WGS84}}selected='selected'{{/srs_name_WGS84}}>WGS84</option>
              <option value='custom' {{#srs_name_custom}}selected='selected'{{/srs_name_custom}}>Add custom</option>
            </select>
          </div>
          <div class='srs {{^srs_name_custom}}hidden{{/srs_name_custom}}'>
            <label for='srs'>Custom</label>
            <input type='text' class='text' id='srs' value='{{ srs }}'/>
          </div>
          <div class='buttons'>
              <input class='submit' type='submit' value='Save' />
          </div>
        </form>
      </div>
    </script>

    <script type='text/html' id='ExportJobEmbedView'>
      <div id='popup-info' class='clearfix pane'>
        <form>
          <div><label for='tile-url'>Tile URL</label>
            <input id='tile-url' class='text' type='text' value='{{ tile_url }}' />
          </div>
          <div>
            <label for='polymaps'>Polymaps</label>
            <textarea class='code-snippet'>
var po = org.polymaps;
var map = po.map()
    .container(document.getElementById('map').appendChild(po.svg('svg')))
    .add(po.interact())
    .add(po.hash())
    // layer setup
    .add(po.image()
    .url(po.url({{ tile_url }}
    + '/{Z}/{X}/{Y}.png')
    ))
    // end layer setup
    .add(po.compass()
    .pan('none'));
</textarea>
        </div>
        <div><label for='openlayers'>OpenLayers</label>
            <textarea class='code-snippet'>
var layer = new OpenLayers.Layer('layer', {{ tile_url }}, { sphericalMercator: true });
            </textarea>
          </div>
        </form>
      </div>
    </script>

    <script type='text/html' id='StylesheetPopupView'>
      <div id='popup-stylesheet' class='clearfix pane'>
        <form>
          <div>
            <label for='stylesheet-name'>Name</label>
            <input id='stylesheet-name' class='text required' type='text' />
          </div>
          <div class='buttons'>
            <input class='submit' type='submit' value='Add stylesheet' />
          </div>
        </form>
      </div>
    </script>

    <script type='text/html' id='PopupMessage'>
      <div id='popup-message' class='clearfix pane {{ type }}'>
        {{ message }}
      </div>
    </script>

    <script type='text/html' id='DropdownView'>
      <a class='show' href='#'>{{title}}</a>
      <div class='dropdown-content'>
        {{{content}}}
      </div>
    </script>

    <script type='text/html' id='ColorSwatchView'>
      <a href='#' class='swatch' style='background-color: {{ color }}' title='{{ color }}'></a>
    </script>

    <script type='text/html' id='ReferenceView'>
      <ul class='reference-links clearfix'>
        <li><a class='active' href='#reference-section-intro'>intro</a></li>
        {{#symbolizers}}
          <li><a href='#reference-section-{{symbolizer}}'>{{symbolizer}}</a></li>
        {{/symbolizers}}
      </ul>
      <div class='reference-section active' id='reference-section-intro'>
        <h2>Introduction</h2>
        <p>TileMill supports the <a href='https://github.com/mapnik/Cascadenik'>Cascadenik</a>
        styling language. It should be familiar to <a href='http://www.w3schools.com/css/'>CSS</a>
        users and easy to pick up for everyone else.</p>
        <p>A simple Cascadenik style looks like</p>
<pre>
#world {
  polygon-fill: #eee;
  line-color: #ccc;
  line-width: 0.5;
}
</pre>
        <p>Which is the <em>selector</em> <code>#world</code>
        - which makes this affect the layer with the id <code>world</code>,
        and then three <em>declarations</em> which color the countries 
        the color <code>#eee</code> and give them a grey line <code>0.5</code>
        units wide.</p>

        <p>There are other selectors you can use to affect different parts of a map</p>

        <ul>
            <li><code>* { }</code>: All layers
            <li><code>.red { }</code>: Only layers with the class 'red'
            <li><code>.blue[zoom>8] { }</code> Only layers with the class blue, zoomed beyond 8
            <li><code>#countries NAME { }</code> Country names, from a layer with id country an a 
        property called NAME
        </ul>
      </div>

      {{#symbolizers}}
        {{>ReferenceSymbolizer}}
      {{/symbolizers}}
    </script>

    <script type='text/html' class='partial' id='ReferenceSymbolizer'>
      <div class='reference-section' id='reference-section-{{symbolizer}}'>
        <h2>{{ symbolizer }}</h2>
        <table class='reference-table'>
          <thead>
            <tr>
              <th>css parameter</th>
              <th>type</th>
              <th>default value</th>
            </tr>
          </thead>
          {{#properties}}
            {{>ReferenceProperty}}
          {{/properties}}
        </table>
      </div>
    </script>

    <script type='text/html' class='partial' id='ReferenceProperty'>
      <tr>
        <th><a {{#doc}}title='{{ doc }}' class='reference-doc-available'{{/doc}}>{{ css }}</a>
        </th>
        <td>{{ type }}</td>
        <td>{{ default_value }}
          {{#default_meaning}}
            <small class='reference-default-meaning'>({{ default_meaning }})</small>
          {{/default_meaning}}
        </td>
      </tr>
    </script>

    <script type='text/html' id='DatasourceRow'>
      <span class='name'>{{ id }}</span>
      <span class='metadata'>{{ bytes }}</span>
      <span class='url'>{{ url }}</span>
    </script>

    <script type='text/html' id='ExportJobQueueView'>
    </script>

    <script type='text/html' id='ExportJobView'>
      <div class='clearfix pane'>
        <form id='form-layer'>
          <div class='messages'></div>
          <span class='fields'>
            <div>
              <label for='filename'>Filename</label>
              <input type='text' class='text' id='filename' value='{{ filename }}'/>
            </div>
            <div><label for='bbox'>Bounding Box</label>
              <input type='text' class='text required' id='bbox' value='{{ bbox }}' />
            </div>
          </span>
          <div class='buttons'>
              <input class='submit' type='submit' value='Save' />
          </div>
        </form>
      </div>
    </script>

    <script type='text/html' id='ExportJobImageView'>
      <div><label for='class'>Pixel Dimmesions</label>
        <input type='text' class='text' id='width' value='{{ width }}'/>
        <span>x</span>
        <input type='text' class='text' id='height' value='{{ height }}'/>
      </div>
    </script>

    <script type='text/html' id='SettingsPopupView'>
      <div id='popup-settings' class='clearfix pane'>
        <form id='form-layer'>
          <div><label for='mode'>Editing mode</label>
            <select id='mode'>
                <option value='normal' {{^minimal_mode}}selected='selected'{{/minimal_mode}}>Normal</option>
                <option value='minimal' {{#minimal_mode}}selected='selected'{{/minimal_mode}}>Minimal</option>
            </select>
          </div>
          <div class='buttons'>
              <input class='submit' type='submit' value='Save' />
          </div>
        </form>
      </div>
    </script>

  <body>
    <div id='app'></div>
  </body>
</html>
